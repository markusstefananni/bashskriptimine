#!/bin/bash
#
# Skript kasutajate lisamiseks failist

# Kontrolli argumentide arvu
if [ $# -ne 1 ]; then
    echo "Kasutusjuhend: $0 failinimi"
    exit 1
fi

failinimi=$1

# Kontrolli, kas fail eksisteerib ja on loetav
if [ -f "$failinimi" -a -r "$failinimi" ]; then
    echo "fail on korras"
    while IFS=':' read -r kasutajanimi parool; do
        # Kontrolli, kas m천lemad v채ljad on olemas
        if [ -n "$kasutajanimi" ] && [ -n "$parool" ]; then
            # Lisa kasutaja ja m채채ra parool
            ./lisa_kasutaja "$kasutajanimi"
            echo "$kasutajanimi:$parool" | chpasswd
        else
            echo "Vigane rida: $kasutajanimi"
        fi
    done < "$failinimi"
else
    echo "probleem failiga $failinimi"
    exit 1
fi
